"0",""
"0","library(dplyr)"
"0","dat <- dat %>% mutate(ID = row_number())"
"0","#moving the ID number to the first column; requires "
"0","dat <- dat%>%select(ID, everything())"
"0",""
"0","Lefevor2017D <- dat%>%"
"0","  select(ID, client, Session, SexualIdentity, Religion1, Religion2, Depression)"
"0",""
"0","Lefevor2017D$ClientID <- rep(c(1:12825), each = 5)"
"0","#rounded Sexual Identity into dichotomous variable"
"0","#85% were heterosexual, "
"0",""
"0","#Rel2 has contrast codes for dominant religion (DR, 0), nondominant religious (NDR, 1) and nondominant unspecified (NDU, -1)"
"0","#Strategy is to figure out the raw score associated with the percentile rank of  -1 and 0, to set the breakpoints for the coding"
"0","#NDU coded as -1"
"0","#19.2+13.5+9.6"
"0","#NDU has bottom 42.3 percent"
"0",""
"0","#DR coded as 0, so quantile cut will be 42.3 + 52.7 = 95th"
"0","#33.4 + 19.3"
"0","#52.7% of sample (according to article) was DR"
"0","#must look up percentile ranks for 5% and 57.5%"
"0",""
"0","#NDR"
"0","#2.3+1+1+.7"
"0","#NDR has 5% of sample"
"0","#42.3+52.7"
"0","quantile(Lefevor2017D$Religion2, probs = c(.423, .95))"
"1","     42.3% "
"1","       95% "
"1","
"
"1","-0.3304528 "
"1"," 2.4446784 "
"1","
"
"0","#effects coding the second Religion variable so that NDU = -1, DR = 0, NDR = 1"
"0","Lefevor2017D$Rel2L2 <- ifelse(Lefevor2017D$Religion2 <= -0.3304528 , -1, "
"0","                             ifelse(Lefevor2017D$Religion2 >= -0.3304529 & Lefevor2017D$Religion2 <= 2.4446784, 0,1))"
"0",""
"0","#creating the  religion variable where DR is 0 and NDR and NDU are both 1"
"0","Lefevor2017D$DRel0 <- plyr::mapvalues(Lefevor2017D$Rel2L2, from = c(-1, 0, 1), to = c(1, 0, 1))"
"2","The following `from` values were not present in `x`: 1
"
"0","#checking "
"0","#DRel0_table <- table(Lefevor2017D$DRel0)"
"0","#prop.table(DRel0_table)"
"0","#heterosexual is -1"
"0","#LGBQQ is 1"
"0","#quantile(Lefevor2017D$SexualIdentity, probs = c(.85))"
"0","Lefevor2017D$SexID <- ifelse(Lefevor2017D$SexualIdentity <= 5.747946, -1,1)"
"0","Lefevor2017D$Het0 <- plyr::mapvalues(Lefevor2017D$SexID, from = c(-1,1), to = c(0,1))"
"0","#Het0_table <- table(Lefevor2017D$Het0)"
"0","#prop.table(Het0_table)#to make sure that 85% are coded 0 for Het"
"0",""
"0","#creating a variable representing the session number for each client, in the article up to 20 sessions were allowed. "
"0","#install.packages(""scales"")"
"0","library(scales)"
"0","#Right from the beginning I centered this so that 0 would represent intake"
"0","Lefevor2017D$Session0 <- as.integer(scales::rescale(Lefevor2017D$Session, to = c(0, 19)))"
"0",""
"0","#creating session waves (1 thru 5) by rank ordering within each person's variable the continuous variable Session that was created in the original simulation"
"0","library(dplyr)"
"0","Lefevor2017D <- Lefevor2017D%>%"
"0","  dplyr::group_by(ClientID) %>%"
"0","  mutate(Index = rank(Session))"
"0",""
"0","#selecting the simulated variables"
"0","Lefevor2017D_sim <- Lefevor2017D%>%"
"0","  select(ClientID, Index, Session0, Depression, DRel0, Het0)"
"0",""
"0","#In the transition from long-to-wide, it seems like you can only do one L1 variable at a time"
"0","#When there are multiple L1 and L2 vars, put all L2 vars on left of tilde"
"0","#The wave/index function should come next; this should be finite (like integers of 1,2,3,4) with a maximum"
"0","#Put the name of the SINGLE L1 variable in the concatonated list"
"0","library(data.table)"
"0","DLfvrWp1<-reshape2::dcast(Lefevor2017D_sim, ClientID + DRel0 + Het0 ~ Index, value.var = c(""Index""))"
"0","#rename the anxiety variable"
"0","DLfvrWp1<-  rename(DLfvrWp1, Index1 = ""1"", Index2 = ""2"", Index3 = ""3"", Index4 = ""4"", Index5 = ""5"")"
"0","DLfvrWp2<-reshape2::dcast(Lefevor2017D_sim, ClientID ~ Index, value.var = c(""Depression""))"
"0","#rename the anxiety variable"
"0","DLfvrWp2<-  rename(DLfvrWp2, Dep1 = ""1"", Dep2 = ""2"", Dep3 = ""3"", Dep4 = ""4"", Dep5 = ""5"")"
"0","#For remaining L1 variable, do them one at a time -- key them from the person-level ID and the wave/index."
"0","DLfvrWp3<-reshape2::dcast(Lefevor2017D_sim, ClientID ~ Index, value.var = c(""Session0""))"
"0","DLfvrWp3<-  rename(DLfvrWp3, Sess1 = ""1"", Sess2 = ""2"", Sess3 = ""3"", Sess4 = ""4"", Sess5 = ""5"")"
"0","#Next, join the dataframes by the person-level ID"
"0","#Only two can be joined at a time"
"0","DLfvrWide <- dplyr::full_join(DLfvrWp1, DLfvrWp2, by = c(""ClientID""))"
"0","DLfvrWide <- dplyr::full_join(DLfvrWide, DLfvrWp3,  by = c(""ClientID""))"
